function tossCoin(){return Math.random()<.5}function invertCoin(e){return!e}function stringFromCoinSequence(e){return e.map(function(e){return e?"T":"H"}).join("")}function coinSequenceEquals(e,t){if(null===e&&null===t)return!0;if(null===e||null===t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function getSimulationSpeed(){return document.getElementById("radioSlow").checked?SLOW_SIMULATION_SPEED:FAST_SIMULATION_SPEED}function updateScoreboard(e,t){document.getElementById("playerSequence").innerHTML=stringFromCoinSequence(e.sequence),document.getElementById("playerScore").innerHTML=e.score.toString(),document.getElementById("computerSequence").innerHTML=stringFromCoinSequence(t.sequence),document.getElementById("computerScore").innerHTML=t.score.toString()}function updateSequenceWindow(e,t){var n=document.getElementById("sequenceWindow");t===SLOW_SIMULATION_SPEED?(n.innerHTML=stringFromCoinSequence(e),n.scrollLeft=n.scrollWidth):n.innerHTML="History not available."}function updateGame(e){function t(){for(;game.history.length>0;)game.history.pop()}function n(e){return e===SLOW_SIMULATION_SPEED?SLOW_SIMULATION_UPDATE_INTERVAL:FAST_SIMULATION_UPDATE_INTERVAL}function o(e){return e===SLOW_SIMULATION_SPEED?SLOW_SIMULATION_TOSS_COUNT:FAST_SIMULATION_TOSS_COUNT}function u(e,n){for(var u=0;u<o(n);u++){if(e.history.push(tossCoin()),updateSequenceWindow(e.history,n),e.history.length>=3){const r=e.history.slice(-3);coinSequenceEquals(e.player.sequence,r)?(e.player.score++,t()):coinSequenceEquals(e.computer.sequence,r)&&(e.computer.score++,t())}updateScoreboard(e.player,e.computer)}}if(game.running){var r=getSimulationSpeed(),i=n(r);game.lastUpdate+i<=e&&(game.lastUpdate=e,u(game,r)),requestAnimationFrame(updateGame)}}function getPlayerSequence(){var e=["firstTails","secondTails","thirdTails"];return e.map(function(e){return document.getElementById(e).checked})}function deriveBestSequence(e){return[invertCoin(e[1]),e[0],e[1]]}function getGoButton(){return document.getElementById("goButton")}function getStopButton(){return document.getElementById("stopButton")}function disableRadioButtons(){for(var e=0;e<radioButtons.length;e++)document.getElementById(radioButtons[e]).disabled=!0}function enableRadioButtons(){for(var e=0;e<radioButtons.length;e++)document.getElementById(radioButtons[e]).disabled=!1}function disableButtons(){getGoButton().disabled=!0,getStopButton().disabled=!0}function enableGoButton(){getGoButton().disabled=!1}function enableStopButton(){getStopButton().disabled=!1}function showReporting(){document.getElementById("reporting").hidden=!1}function clickedGo(){disableRadioButtons(),disableButtons(),game.player={sequence:getPlayerSequence(),score:0},game.computer={sequence:deriveBestSequence(game.player.sequence),score:0},game.history=[],game.lastUpdate=window.performance.now(),game.running=!0,showReporting(),updateScoreboard(game.player,game.computer),enableStopButton(),requestAnimationFrame(updateGame)}function clickedStop(){disableButtons(),game.running&&(game.running=!1,enableRadioButtons(),enableGoButton())}const SLOW_SIMULATION_SPEED=1,FAST_SIMULATION_SPEED=2,SLOW_SIMULATION_UPDATE_INTERVAL=500,FAST_SIMULATION_UPDATE_INTERVAL=100,SLOW_SIMULATION_TOSS_COUNT=1,FAST_SIMULATION_TOSS_COUNT=100,headsButtons=["firstHeads","secondHeads","thirdHeads"],tailsButtons=["firstTails","secondTails","thirdTails"],radioButtons=headsButtons.concat(tailsButtons);var game={};getGoButton().addEventListener("click",clickedGo),getStopButton().addEventListener("click",clickedStop);